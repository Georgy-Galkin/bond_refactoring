from KZ_main import ETL
from KZ_main_zip import extract
import os
import bondetl as be
import re

path = 'N:/KZ NB/'

extracted_path = path+'extracted_data/'


extract() #Этот кусок разархивирует файлы, но не переименовывает!!!! Нужно убрать _arch или другие теги к файлу так как дальнейший скрипт обрабатывает чистые базы

'''
headers = ['MKT_TAG','PROD_TAG','PER_TAG','F000000000000000000100000000000000000000','F000000000000000000200000000000000000000','F000000000000000000300000000000000000000',
    'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000','F000000000000000013400000000000000000000','F000000000000000013500000000000000000000', 
    'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000', 'F000000000000000075800000000000000000000', 
    'F000000000000000086200000000000000000000']
base_name = 'BEN_KZ' 
nameslist = ['KZBONBENCIP_SFF'] 
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk
#nameslist = ['SFF_NSFFVST','SFF_NSRFDST'] 
'''

headers = ['MKT_TAG','PROD_TAG','PER_TAG','F000000000000000000100000000000000000000', 'F000000000000000000200000000000000000000', 'F000000000000000000300000000000000000000',
'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000', 'F000000000000000013400000000000000000000', 'F000000000000000013500000000000000000000',
'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000', 'F000000000000000075800000000000000000000',
'F000000000000000086200000000000000000000']
base_name = 'DIN_KZ'
nameslist = ['KZBONDINCIP_SFF'] 
#nameslist = ['SFF_BONFFVSTP','SFF_BONRFDSTP'] 
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk


headers =  ['MKT_TAG','PROD_TAG','PER_TAG', 'F000000000000000000100000000000000000000', 'F000000000000000000200000000000000000000', 'F000000000000000000300000000000000000000',
'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000', 'F000000000000000013400000000000000000000', 'F000000000000000013500000000000000000000',
'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000', 'F000000000000000075800000000000000000000',
'F000000000000000086200000000000000000000']
base_name = 'OLV_KZ'
nameslist = ['KZBONOLVCIP_SFF']
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk



headers = ['MKT_TAG','PROD_TAG','PER_TAG', 'F000000000000000000100000000000000000000', 'F000000000000000000200000000000000000000', 'F000000000000000000300000000000000000000',
'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000', 'F000000000000000013400000000000000000000', 'F000000000000000013500000000000000000000',
'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000', 'F000000000000000075800000000000000000000',
'F000000000000000086200000000000000000000']
base_name = 'VGC_KZ'
nameslist = ['KZBONVGCCIP_SFF']
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk


headers = ['MKT_TAG','PROD_TAG','PER_TAG', 'F000000000000000000100000000000000000000', 'F000000000000000000200000000000000000000', 'F000000000000000000300000000000000000000',
'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000', 'F000000000000000013400000000000000000000', 'F000000000000000013500000000000000000000',
'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000','F000000000000000075800000000000000000000',
'F000000000000000086200000000000000000000']
base_name = 'VGP_KZ'
nameslist = ['KZBONVGPCIP_SFF']
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk


headers = ['MKT_TAG','PROD_TAG','PER_TAG', 'F000000000000000000100000000000000000000', 'F000000000000000000200000000000000000000', 'F000000000000000000300000000000000000000',
'F000000000000000006900000000000000000000', 'F000000000000000011300000000000000000000', 'F000000000000000013400000000000000000000', 'F000000000000000013500000000000000000000',
'F000000000000000014500000000000000000000', 'F000000000000000014600000000000000000000', 'F000000000000000075500000000000000000000','F000000000000000075800000000000000000000',
'F000000000000000086200000000000000000000']
base_name = 'VGT_KZ'
nameslist = ['KZBONVGCIP_SFF']
ETL(headers,base_name,nameslist,path,extracted_path,0,0) # 1 for skip split_CSV,second for skip bulk






#cursor = be.SQL('Nielsen')
#query = 'exec Nielsen_ETL'
#print('Running stored procedure')
#cursor.Query(sql_query=query)

